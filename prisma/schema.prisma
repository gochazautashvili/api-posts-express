generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextIndex"]
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  username String
  gmail    String @unique
  avatar   String
  password String

  like  Like[]
  post  Post[]
  saved Saved[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([id, username])
}

model Post {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  body         String
  image        String
  likeQuantity Int    @default(0)

  like  Like[]
  saved Saved[]

  user   User?   @relation(fields: [userId], references: [id])
  userId String? @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@fulltext([body(sort: Desc)])
}

model Like {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  user   User   @relation(fields: [userId], references: [id])
  userId String @db.ObjectId
  post   Post   @relation(fields: [postId], references: [id])
  postId String @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Saved {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  user   User   @relation(fields: [userId], references: [id])
  userId String @db.ObjectId
  post   Post   @relation(fields: [postId], references: [id])
  postId String @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
